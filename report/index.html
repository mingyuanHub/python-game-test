<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>iview example</title>
    <link rel="stylesheet" type="text/css" href="iview.css">
    <script type="text/javascript" src="vue.min.js"></script>
    <script type="text/javascript" src="iview.min.js"></script>
    <script src="https://unpkg.com/ionicons@4.2.2/dist/ionicons.js"></script>
    <script src="https://code.highcharts.com.cn/highcharts/highcharts.js"></script>
    <script src="https://code.highcharts.com.cn/highcharts/highcharts-3d.js"></script>
    <script src="https://code.highcharts.com.cn/highcharts/modules/exporting.js"></script>
    <script src="https://img.hcharts.cn/highcharts-plugins/highcharts-zh_CN.js"></script>
    <script src="https://code.highcharts.com.cn/highcharts/themes/grid-light.js"></script>
    
</head>
<body>

<div id="app">
        <div class="layout">
            <Layout>
                <Header :style="{position: 'fixed', width: '100%'}">
                    <i-menu mode="horizontal" theme="dark" active-name="1">
                        <div class="layout-logo"></div>
                        <div class="layout-nav">
                            <Menu-Item name="1">
                                <Icon type="md-pulse"></Icon>
                                <!-- <Icon type="ios-navigate"></Icon> -->
                                测试用例报告
                            </Menu-Item>
                            <!-- <Menu-Item name="2">
                                <Icon type="ios-keypad"></Icon>
                                Item 2
                            </Menu-Item> -->
                        </div>
                    </i-menu>
                </Header>
                 <Content :style="{margin: '68px 0px 0px 0px', background: '#fff', minHeight: '600px'}">
                    <row  :gutter="16">
                        <i-col span="12">
                            <Collapse simple>
                                <Panel name="1">
                                    史蒂夫·乔布斯
                                    <p slot="content">史蒂夫·乔布斯（Steve Jobs），1955年2月24日生于美国加利福尼亚州旧金山，美国发明家、企业家、美国苹果公司联合创办人。</p>
                                </Panel>
                                <Panel name="2">
                                    斯蒂夫·盖瑞·沃兹尼亚克
                                    <p slot="content">斯蒂夫·盖瑞·沃兹尼亚克（Stephen Gary Wozniak），美国电脑工程师，曾与史蒂夫·乔布斯合伙创立苹果电脑（今之苹果公司）。斯蒂夫·盖瑞·沃兹尼亚克曾就读于美国科罗拉多大学，后转学入美国著名高等学府加州大学伯克利分校（UC Berkeley）并获得电机工程及计算机（EECS）本科学位（1987年）。</p>
                                </Panel>
                                <Panel name="3">
                                    乔纳森·伊夫
                                    <p slot="content">乔纳森·伊夫是一位工业设计师，现任Apple公司设计师兼资深副总裁，英国爵士。他曾参与设计了iPod，iMac，iPhone，iPad等众多苹果产品。除了乔布斯，他是对苹果那些著名的产品最有影响力的人。</p>
                                </Panel>
                            </Collapse>
                        </i-col>
                        <i-col span="12" style="outline-width: 1px">
                            <div id="container" style="height: 400px;"></div>
                        </i-col>
                    </row>
                </Content>
                <Footer class="layout-footer-center">2016-2019 &copy; Zhuan Fang</Footer>
            </Layout>
        </div>
</div>
<script>
    new Vue({
        el: '#app',
        data () {
            return {
                header_info: {
                    "start_time":"{{header_info.start_time}}",
                    "total":{{header_info.status.total}},
                    "success":{{header_info.status.total - header_info.status.error - header_info.status.failure - header_info.status.skip }},
                    "error":{{header_info.status.error}},
                    "failure":{{header_info.status.failure}},
                    "skip":{{header_info.status.skip}},
                    "duration":"{{header_info.status.duration}}",
                },
                all_results: {
                    {% for test_case_name, tests_results in all_results.items() %}
                            "{{ test_case_name }}":[
                                {% if tests_results %}
                                    {% for test_case in tests_results %}
                                        {
                                            "test_description":"{{test_case.test_description}}",
                                            "outcome":"{{test_case.outcome}}",
                                            "SUCCESS":{{test_case.SUCCESS}},
                                            "SKIP":{{test_case.SKIP}},
                                            "FAILURE":{{test_case.FAILURE}},
                                            "stdout":{% if test_case.stdout %} '{{test_case.stdout | replace('\n','') | replace('\r','') | replace('\n\r','') }}' {% else %} "" {% endif %},
                                            "err1": {% if test_case.err %} '{{test_case.err[0].__name__}}' {% else %} "" {% endif %},
                                            "err2":  {% if test_case.err %} '{{test_case.err[1]}}' {% else %} "" {% endif %},
                                            "err_info": {% if test_case.err %} '{{test_case.test_exception_info | replace('\n','') | replace('\r','') | replace('\n\r','') }}' {% else %} "" {% endif %}, 
                                        },
                                    {% endfor %}
                                {% endif %}
                            ],
                    {% endfor %}
                },
                summaries:{
                    {% for test_case_name, tests_results in all_results.items() %}
                            "{{ test_case_name }}":"{{ summaries[test_case_name] }}",
                    {% endfor %}
                },
            }
        },
        methods: {
            
        },
        mounted:function()
        {
            var chart = Highcharts.chart('container', {
                chart: {
                    type: 'pie',
                    options3d: {
                        enabled: true,
                        alpha: 45,
                        beta: 0
                    }
                },
                title: {
                    text: 'Python Unittest Result'
                },
                subtitle: {
                    text: 'Zhuan Fang 2019 '
                },
                plotOptions: {
                    pie: {
                        allowPointSelect: true,
                        cursor: 'pointer',
                        depth: 35,
                        dataLabels: {
                            enabled: true,
                            format: '{point.name}'
                        }
                    }
                },
                series: [
                    {
                        name: 'Test Case ',
                        data: [
                            ['成功', this.header_info.success],
                            {
                                name: '失败',
                                y: this.header_info.failure,
                                sliced: true,
                                selected: true,
                            },
                            ['报错', this.header_info.error],
                            ['忽略', this.header_info.skip],
                        ]
                    }
                ]
            })
        }
    })
  </script>
</body>
</html>

<style>
    .layout{
        border: 1px solid #d7dde4;
        background: #ffdb43;
        position: relative;
        border-radius: 4px;
        overflow: hidden;
    }
    .layout-logo{
        width: 100px;
        height: 30px;
        background: #5b6270;
        border-radius: 3px;
        float: left;
        position: relative;
        top: 15px;
        left: 20px;
    }
    .layout-nav{
        width: 420px;
        margin: 0 auto;
        margin-right: 20px;
    }
    .layout-footer-center{
        text-align: center;
    }
    .ivu-menu-dark {
        background: #3b6d95;
    }
    .ivu-layout{
        background:#ffd739;
    }
</style>